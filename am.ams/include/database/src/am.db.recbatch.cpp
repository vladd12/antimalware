#include "../am.db.recbatch.hpp"

namespace db {
	// RecordBatch constructor with params
	RecordBatch::RecordBatch(uint16_t batchSize) noexcept(false) :
		_ptrRecords(nullptr), _batchSize(batchSize) {
		_ptrRecords = new Record[_batchSize];
	}

	// RecordBatch destructor
	RecordBatch::~RecordBatch() noexcept(false) {
		if (_ptrRecords != nullptr) delete[] _ptrRecords;
	}

	// Read records from DB file to batch of records
	// Return false if batch is not fully filled, else return true
	bool RecordBatch::ReadRecords(DBFileReader& dbfr) {
		std::size_t i;
		for (i = 0; i < _batchSize; i++) {
			if (!dbfr.ReadNextRecord(&_ptrRecords[i])) {
				break;
			}
		}
		return (i == _batchSize);
	}

}

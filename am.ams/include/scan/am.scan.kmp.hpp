#ifndef AM_SCAN_KMP_H
#define AM_SCAN_KMP_H

#include <cstdint>
#include <cstdlib>
#include <vector>

namespace scan {
	// Knuth-Morris-Pratt Algorithm for pattern matching in data
	class KMPMatch {
	private:
		// Computes the failure function using a boot-strapping process,
		// where the pattern is matched against itself
		static void ComputeFailure(std::vector<std::size_t>& failure,
		  const uint8_t* pattern, const std::size_t patternSize);

	public:
		// Finds all occurrence of the pattern in the data
		static std::vector<std::size_t> IndexesOf(const uint8_t* data, const std::size_t dataSize,
		  const uint8_t* pattern, const std::size_t patternSize);

	};

}

#endif // AM_SCAN_KMP_H

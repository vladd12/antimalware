#ifndef BASE_PIPE_H
#define BASE_PIPE_H

#include <stdexcept>
#include <string>
#include <Windows.h>
#include "am.ipc.message.hpp"
#include "am.trace.log-tracer.hpp"

namespace ipc {
	// Base pipe class 
	class IPC_LIB_API BasePipe {
	protected:
		HANDLE hPipe;
		DWORD errCode;

	public:
		// Default constructor
		BasePipe() noexcept;

		// Virtual function for creating pipe
		virtual bool CreatePipe(const std::string& pipeName) noexcept = 0;

		// Sending message
		bool Send(MessageHolder& msg) noexcept;

		// Reading message
		MessageHolder Read() noexcept;

		// Returns handle of pipe
		HANDLE GetHandle() noexcept;

		// Closing pipe
		bool Close() noexcept;

	};

}

#endif // BASE_PIPE_H
